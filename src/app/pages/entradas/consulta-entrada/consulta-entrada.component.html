<mat-card [nbSpinner]="spinner" [nbSpinnerMessage]="spinner">
  <mat-card-title *ngIf="!mostrarEntrada && !updateEntrada">
    {{'GLOBAL.consultar_entrada' | translate}}
  </mat-card-title>
  <mat-card-title *ngIf="mostrarEntrada">
    {{'GLOBAL.detalle_entrada' | translate}} {{ entradaEspecifica?.Consecutivo }}
  </mat-card-title>
  <mat-card-subtitle *ngIf="!(mostrarEntrada || updateEntrada)">
    {{'GLOBAL.mensaje_consulta_entrada' | translate}}
  </mat-card-subtitle>

  <mat-card-content>

    <!-- CARD PARA MOSTRAR LAS SOLICITUDES *ngIf="!detalle" -->

    <div class="container-tabla" *ngIf="mostrar">
      <ng2-smart-table [settings]="settings" [source]="source" (delete)="onDelete($event)" (edit)="onEdit($event)"
        (create)="onRegister($event)">
      </ng2-smart-table>
    </div>

    <div *ngIf="updateEntrada">
      <ngx-registro [EntradaId]="entradaId" [ActaParaEditar]="actaRecibidoId" (volver)="onVolver($event)"></ngx-registro>
    </div>

    <!-- CARD PARA MOSTRAR LOS DETALLES DE LAS SOLICITUDES -->

    <div *ngIf="mostrarEntrada && entradaEspecifica">

      <mat-vertical-stepper #stepper>
        <mat-step label="{{'GLOBAL.info' | translate}}">

          <!-- ENTRADA -->
          <div class="row">
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.consecutivo' | translate }}</strong>: {{
                entradaEspecifica.Consecutivo }}</p>
            </div>
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.tipo_entrada' | translate }}</strong>
                : {{ entradaEspecifica.TipoEntradaId.Nombre }}</p>
            </div>
          </div>

          <!-- ACTA RECIBIDO -->
          <div class="row">
            <div class="col">
              <a [href]="linkActa" class="text-uppercase"><strong>{{'GLOBAL.Acta_Recibido.ActaNo' | translate }}</strong>
                : {{ entradaEspecifica.ActaRecibidoId }}</a>
            </div>
            <div class="col" *ngIf="Proveedor">
              <p class="text-uppercase"><strong>{{'GLOBAL.proveedor' | translate }}</strong>
                : {{ (Proveedor.Numero ? Proveedor.Numero + " - " : "") + Proveedor.NombreCompleto }}</p>
            </div>
          </div>

          <div *ngIf="factura" class="row">
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.factura' | translate }}</strong>:
                {{ factura.Consecutivo }}</p>
            </div>
          </div>

          <!-- ADQUISICIÓN -->

          <div *ngIf="entradaEspecifica.TipoEntradaId.Nombre === 'Adquisición'" class="row">
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.contrato' | translate }}:</strong>
                {{ contrato.NumeroContratoSuscrito + ' ' + ('GLOBAL.de' | translate) + ' '+ contrato.Vigencia }}</p>
            </div>
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.tipo_contrato' | translate }}:</strong> {{
                contrato.TipoContrato }}</p>
            </div>
          </div>

          <div *ngIf="entradaEspecifica.TipoEntradaId.Nombre === 'Adquisición'" class="row">
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.ordenador_gasto' | translate }}</strong>
                : {{ contrato.OrdenadorGasto.NombreOrdenador }}
              </p>
            </div>
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.Cargo' | translate }}</strong>: {{
                contrato.OrdenadorGasto.RolOrdenadorGasto }}</p>
            </div>
          </div>

          <div *ngIf="entradaEspecifica.TipoEntradaId.Nombre === 'Adquisición'" class="row">
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.supervisor' | translate }}</strong>: {{
                contrato.Supervisor.Nombre }}</p>
            </div>
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.Cargo' | translate }}</strong>: {{ contrato.Supervisor.Cargo
                }}</p>
            </div>
          </div>

          <!-- ELABORACIÓN PROPIA -->
          <div *ngIf="entradaEspecifica.TipoEntradaId.Nombre === 'Elaboración Propia'" class="row">
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.ordenador_gasto' | translate }}</strong>
                : capturar
              </p>
            </div>
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.Cargo' | translate }}</strong>: capturar</p>
            </div>
          </div>

          <div *ngIf="entradaEspecifica.TipoEntradaId.Nombre === 'Elaboración Propia'" class="row">
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.Solicitante' | translate }}</strong>: capturar </p>
            </div>
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.Cargo' | translate }}</strong>: capturar</p>
            </div>
          </div>

          <!-- DONACIÓN -->
          <div *ngIf="entradaEspecifica.TipoEntradaId.Nombre === 'Donación'" class="row">
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.numero_contrato' | translate }}</strong>: {{
                entradaEspecifica.ContratoId }}</p>
            </div>
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.tipo_contrato' | translate }}</strong>: {{
                contrato.TipoContrato }}</p>
            </div>
          </div>

          <div *ngIf="entradaEspecifica.TipoEntradaId.Nombre === 'Donación'" class="row">
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.ordenador_gasto' | translate }}</strong>
                : {{ contrato.OrdenadorGasto.NombreOrdenador }}
              </p>
            </div>
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.Cargo' | translate }}</strong>: {{
                contrato.OrdenadorGasto.RolOrdenadorGasto }}</p>
            </div>
          </div>


          <div *ngIf="entradaEspecifica.TipoEntradaId.Nombre === 'Donación'" class="row">
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.supervisor' | translate }}</strong>: {{
                contrato.Supervisor.Nombre }}</p>
            </div>
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.Cargo' | translate }}</strong>: {{ contrato.Supervisor.Cargo
                }}</p>
            </div>
          </div>

          <div *ngIf="entradaEspecifica.TipoEntradaId.Nombre === 'Donación'" class="row">
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.Solicitante' | translate }}</strong>: capturar </p>
            </div>
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.Cargo' | translate }}</strong>: capturar</p>
            </div>
          </div>

          <!-- REPOSICIÓN -->
          <div *ngIf="entradaEspecifica.TipoEntradaId.Nombre === 'Reposición'" class="row">
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.Encargado' | translate }} </strong>: {{encargado}}</p>
            </div>
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.Placa' | translate }}</strong>: {{Placa}}</p>
            </div>
          </div>
          <!-- HACER CUANDO ESTE LISTO -->

          <!-- SOBRANTE -->
          <div *ngIf="entradaEspecifica.TipoEntradaId.Nombre === 'Sobrante'" class="row">
          </div>


          <!-- TERCEROS -->
          <div *ngIf="entradaEspecifica.TipoEntradaId.Nombre === 'Terceros'" class="row">
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.numero_contrato' | translate }}</strong>: {{
                entradaEspecifica.ContratoId }}</p>
            </div>
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.tipo_contrato' | translate }}</strong>: {{
                contrato.TipoContrato }}</p>
            </div>
          </div>

          <div *ngIf="entradaEspecifica.TipoEntradaId.Nombre === 'Terceros'" class="row">
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.ordenador_gasto' | translate }}</strong>
                : {{ contrato.OrdenadorGasto.NombreOrdenador }}
              </p>
            </div>
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.Cargo' | translate }}</strong>: {{
                contrato.OrdenadorGasto.RolOrdenadorGasto }}</p>
            </div>
          </div>

          <div *ngIf="entradaEspecifica.TipoEntradaId.Nombre === 'Terceros'" class="row">
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.supervisor' | translate }}</strong>: {{
                contrato.Supervisor.Nombre }}</p>
            </div>
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.Cargo' | translate }}</strong>: {{ contrato.Supervisor.Cargo
                }}</p>
            </div>
          </div>

          <!-- CAJA MENOR -->
          <div *ngIf="entradaEspecifica.TipoEntradaId.Nombre === 'Caja menor'" class="row">
            <div *ngIf="Supervisor!=undefined" class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.supervisor' | translate }}</strong>: {{
                Supervisor.TerceroPrincipal.NombreCompleto }}</p>
            </div>
            <div *ngIf="Supervisor!=undefined" class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.dependencia' | translate }}</strong>: {{
                Supervisor.Dependencia.Nombre}}</p>
            </div>
          </div>

          <div *ngIf="entradaEspecifica.TipoEntradaId.Nombre === 'Caja menor'" class="row">
            <div *ngIf="Ordenador!=undefined" class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.ordenador_gasto' | translate }}</strong>: {{
                Ordenador.TerceroPrincipal.NombreCompleto }}</p>
            </div>
          </div>

          <!-- ADICIONES Y MEJORAS -->
          <div *ngIf="entradaEspecifica.TipoEntradaId.Nombre === 'Adiciones y mejoras'" class="row">
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.numero_contrato' | translate }}</strong>: {{
                entradaEspecifica.ContratoId }}</p>
            </div>
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.tipo_contrato' | translate }}</strong>: {{
                contrato.TipoContrato }}</p>
            </div>
          </div>

          <div *ngIf="entradaEspecifica.TipoEntradaId.Nombre === 'Adiciones y mejoras'" class="row">
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.ordenador_gasto' | translate }}</strong>
                : {{ contrato.OrdenadorGasto.NombreOrdenador }}
              </p>
            </div>
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.Cargo' | translate }}</strong>: {{
                contrato.OrdenadorGasto.RolOrdenadorGasto }}</p>
            </div>
          </div>

          <div *ngIf="entradaEspecifica.TipoEntradaId.Nombre === 'Adiciones y mejoras'" class="row">
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.supervisor' | translate }}</strong>: {{
                contrato.Supervisor.Nombre }}</p>
            </div>
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.Cargo' | translate }}</strong>: {{ contrato.Supervisor.Cargo
                }}</p>
            </div>
          </div>

          <!-- INTANGIBLES ADQUIRIDOS -->
          <div *ngIf="entradaEspecifica.TipoEntradaId.Nombre === 'Intangibles'" class="row">
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.numero_contrato' | translate }}</strong>: {{
                entradaEspecifica.ContratoId }}</p>
            </div>
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.tipo_contrato' | translate }}</strong>: {{
                contrato.TipoContrato }}</p>
            </div>
          </div>

          <div *ngIf="entradaEspecifica.TipoEntradaId.Nombre === 'Intangibles'" class="row">
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.ordenador_gasto' | translate }}</strong>
                : {{ contrato.OrdenadorGasto.NombreOrdenador }}
              </p>
            </div>
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.Cargo' | translate }}</strong>: {{
                contrato.OrdenadorGasto.RolOrdenadorGasto }}</p>
            </div>
          </div>

          <div *ngIf="entradaEspecifica.TipoEntradaId.Nombre === 'Intangibles'" class="row">
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.supervisor' | translate }}</strong>: {{
                contrato.Supervisor.Nombre }}</p>
            </div>
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.Cargo' | translate }}</strong>: {{ contrato.Supervisor.Cargo
                }}</p>
            </div>
          </div>

          <!-- PROVISIONAL -->
          <div *ngIf="entradaEspecifica.TipoEntradaId.Nombre === 'Provisional'" class="row">
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.numero_contrato' | translate }}</strong>: {{
                entradaEspecifica.ContratoId }}</p>
            </div>
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.tipo_contrato' | translate }}</strong>: {{
                contrato.TipoContrato }}</p>
            </div>
          </div>

          <div *ngIf="entradaEspecifica.TipoEntradaId.Nombre === 'Provisional'" class="row">
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.ordenador_gasto' | translate }}</strong>
                : {{ contrato.OrdenadorGasto.NombreOrdenador }}
              </p>
            </div>
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.Cargo' | translate }}</strong>: {{
                contrato.OrdenadorGasto.RolOrdenadorGasto }}</p>
            </div>
          </div>

          <div *ngIf="entradaEspecifica.TipoEntradaId.Nombre === 'Provisional'" class="row">
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.supervisor' | translate }}</strong>: {{
                contrato.Supervisor.Nombre }}</p>
            </div>
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.Cargo' | translate }}</strong>: {{ contrato.Supervisor.Cargo
                }}</p>
            </div>
          </div>

          <!-- COMPRAS EXTRANJERAS -->
          <div *ngIf="entradaEspecifica.TipoEntradaId.Nombre === 'Compras extranjeras'" class="row">
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.numero_contrato' | translate }}</strong>: {{
                entradaEspecifica.ContratoId }}</p>
            </div>
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.tipo_contrato' | translate }}</strong>: {{
                contrato.TipoContrato }}</p>
            </div>
          </div>

          <div *ngIf="entradaEspecifica.TipoEntradaId.Nombre === 'Compras extranjeras'" class="row">
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.ordenador_gasto' | translate }}</strong>
                : {{ contrato.OrdenadorGasto.NombreOrdenador }}
              </p>
            </div>
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.Cargo' | translate }}</strong>: {{
                contrato.OrdenadorGasto.RolOrdenadorGasto }}</p>
            </div>
          </div>

          <div *ngIf="entradaEspecifica.TipoEntradaId.Nombre === 'Compras extranjeras'" class="row">
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.supervisor' | translate }}</strong>: {{
                contrato.Supervisor.Nombre }}</p>
            </div>
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.Cargo' | translate }}</strong>: {{ contrato.Supervisor.Cargo
                }}</p>
            </div>
          </div>
          <div *ngIf="entradaEspecifica.TipoEntradaId.Nombre === 'Compras extranjeras'" class="row">
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.Cargo' | translate }}</strong>: {{
                entradaEspecifica.RegistroImportacion
                }}</p>
            </div>
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.trm' | translate }}</strong> {{
                entradaEspecifica.TasaRepresentativaMercado }}</p>
            </div>
          </div>
          <div *ngIf="entradaEspecifica.TipoEntradaId.Nombre === 'Compras extranjeras'" class="row">
            <div class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.Divisa' | translate }}</strong>: {{ entradaEspecifica.Divisa
                }}</p>
            </div>
          </div>

          <!-- INTANGIBLES DESARROLLADOS -->
          <div *ngIf="entradaEspecifica.TipoEntradaId.Nombre === 'Desarrollo interior'" class="row">
            <div *ngIf="Supervisor!=undefined" class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.supervisor' | translate }}</strong>: {{
                Supervisor.TerceroPrincipal.NombreCompleto }}</p>
            </div>
            <div *ngIf="Supervisor!=undefined" class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.dependencia' | translate }}</strong>: {{
                Supervisor.Dependencia.Nombre}}</p>
            </div>
          </div>

          <div *ngIf="entradaEspecifica.TipoEntradaId.Nombre === 'Desarrollo interior'" class="row">
            <div *ngIf="Ordenador!=undefined" class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.ordenador_gasto' | translate }}</strong>: {{
                Ordenador.TerceroPrincipal.NombreCompleto }}</p>
            </div>
          </div>

          <!-- APROVECHAMIENTOS -->

          <div *ngIf="entradaEspecifica.TipoEntradaId.Nombre === 'Partes por Aprovechamientos'" class="row">
            <div *ngIf="Supervisor!=undefined" class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.supervisor' | translate }}</strong>: {{
                Supervisor.TerceroPrincipal.NombreCompleto }}</p>
            </div>
            <div *ngIf="Supervisor?.Dependencia" class="col">
              <p class="text-uppercase"><strong>{{'GLOBAL.dependencia' | translate }}</strong>: {{
                Supervisor.Dependencia.Nombre}}</p>
            </div>
          </div>

          <!-- OBSERVACIONES -->
          <div class=" row">
            <div class="col">
              <p *ngIf="entradaEspecifica.Observacion !== ''" class="text-uppercase">
                <strong>{{'GLOBAL.observaciones' | translate }}</strong>: {{ entradaEspecifica.Observacion }}
              </p>
              <p *ngIf="entradaEspecifica.Observacion === ''" class="text-uppercase">
                <strong>{{'GLOBAL.observaciones' | translate }}</strong>: N/A
              </p>
            </div>
          </div>

          <!-- SOPORTES -->
          <label *ngIf="documentoId" class="text-uppercase"><strong>Soportes:</strong></label>
          <button *ngIf="documentoId" mat-button type="button" (click)="loadSoporte()">
            <mat-icon>cloud_download</mat-icon>
          </button>
        </mat-step>
        <mat-step label="{{'GLOBAL.elementos_entrada' | translate}}">
          <ngx-gestionar-elementos [ActaRecibidoId]="actaRecibidoId" [Modo]="'ver'"></ngx-gestionar-elementos>
        </mat-step>
        <mat-step label="{{'GLOBAL.Comprobante_Contable.Titulo' | translate}}" *ngIf="trContable">
          <ngx-comprobante [ajusteInfo]="trContable" [modo]="'get'" [consecutivo]="entradaEspecifica?.Consecutivo"
            [fecha]="trContable.fecha" [concepto]="trContable.concepto">
          </ngx-comprobante>
        </mat-step>
      </mat-vertical-stepper>

      <ngx-ver-comprobante [consecutivo]="entradaEspecifica.Consecutivo" [transaccion]="transaccionContable"
        *ngIf="verComponente && transaccionContable"></ngx-ver-comprobante>

    </div>
  </mat-card-content>

  <mat-card-actions *ngIf="(mostrarEntrada && modo === 'revision' && !verComponente) || mostrarEntrada">
    <div *ngIf="movimiento?.EstadoMovimientoId?.Nombre === 'Entrada En Trámite' && (modo === 'revision' && !verComponente)"
      style="padding-bottom: 3rem;">
      <button mat-flat-button color="primary" class="float-left text-uppercase" (click)="confirmSubmit(false)">
        {{'GLOBAL.Acta_Recibido.VerificacionActa.Rechazar' | translate}}
      </button>
      <button mat-flat-button color="primary" class="float-right text-uppercase" (click)="confirmSubmit(true)">
        {{'GLOBAL.Acta_Recibido.VerificacionActa.Verificar' | translate}}
      </button>
    </div>
    <div *ngIf="mostrarEntrada">
      <button mat-flat-button color="primary" class="float-left text-uppercase" (click)="onVolver()">
        {{'GLOBAL.volver' | translate}}
      </button>
    </div>
  </mat-card-actions>

</mat-card>